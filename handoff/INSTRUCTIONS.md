# プロジェクト: Jinnai - 思考を触発する読書ノートアプリ
## Claude Code への引き継ぎ指示書

**目的**: ユニークなAIパートナー「陣内（Jinnai）」を搭載した「読書ノートアプリ」の開発を完了させること。
**現状**: ベースとなるインフラ（`AppShell`）は検証済みで正常に動作している。以前の `Layout` コンポーネントは致命的なレンダリングエラー（画面が真っ白になる）を引き起こしたため、廃止した。検証済みの `AppShell` 内部でUIを再構築する必要がある。

---

### 1. コアコンセプト: "Jinnai" (AIペルソナ)
陣内は「役に立つアシスタント」ではない。彼は **「知的な壁打ち相手（スパーリングパートナー）」** である。
*   **口調**: 尊大で鋭く、批判的だが、深い洞察力を持つ。「俺」「お前」を使用する。
*   **役割**: ユーザーの固定観念を壊し、より深い思考を促すこと。
*   **主な振る舞い**:
    *   **悪魔の代弁者 (Devil's Advocate)**: ユーザーが「Xは重要だ」と言えば、陣内は「なぜだ？ むしろXこそが問題なんじゃないか？」と反論する。
    *   **行動のトリガー (Action Trigger)**: ユーザーが抽象的な思考を書くと、陣内は具体的な行動を要求する。「で、具体的にいつやるんだ？」
    *   **セレンディピティ (Serendipity)**: ユーザーのメモを、一見関係なさそうなトピック（映画、ハイキング、歴史など）と結びつけ、新しいアイデアを誘発する。

### 2. 技術的コンテキストと制約
*   **スタック**: React, Vite, TypeScript, Tailwind CSS (**v3** - v4へアップグレードしないこと), Lucide React.
*   **現在の状態**:
    *   `src/App.tsx`: 現在 `AppShell` を使用中（動作確認済み）。
    *   `src/components/ui/Layout.tsx`: **破損/汚染されている**。使用禁止。`AppShell.tsx` を参照すること。
    *   `node_modules`: 最近再インストール済み。
*   **ポート**: ローカルホストのポート 5173-5176 はゾンビプロセスによりブロックされている可能性がある。**5177** 以降を使用すること。

### 3. 実装タスク (ステップ・バイ・ステップ)

#### フェーズ 1: コンポーネントの移行 (セーフモード)
以下のコンポーネントは存在するが、現在 `App.tsx` でコメントアウトされているか、`AppShell` への統合が必要である。
1.  **JinnaiChat の統合**:
    *   `./components/jinnai/JinnaiChat` から `JinnaiChat` をインポートする。
    *   それを `AppShell` の `sidebarContent` プロップに配置する。
    *   クラッシュせずにレンダリングされるか確認する。
2.  **Bookshelf (本棚) の統合**:
    *   `./components/bookshelf/Bookshelf` から `Bookshelf` をインポートする。
    *   `AppShell` のメインコンテンツエリアにレンダリングする。
3.  **NoteEditor (ノートエディタ) の統合**:
    *   `./components/arena/NoteEditor` から `NoteEditor` をインポートする。
    *   「タグ管理」機能（`NoteEditor.tsx` に追加済み）が正しく動作することを確認する。

#### フェーズ 2: 陣内のロジック洗練
ロジックは `src/hooks/useJinnai.tsx` にある。以下のトリガーが実装されているか確認・修正する。
*   **`useJinnai.tsx` のレビュー**: 「悪魔の代弁者」「行動トリガー」「セレンディピティ」モードのロジックを確認する。
*   **トリガーロジック**: タイマーだけでなく、特定のキーワード（例：「計画」「マインドセット」「成長」）が入力された時にも陣内が話すようにする。

#### フェーズ 3: 最終的なUIの仕上げ
*   **テーマ**: 「知的なダークブルー」と「警告のイエロー」の美学を維持する。
*   **アニメーション**: `framer-motion` を使用して、スムーズなトランジション（陣内が介入してくる時など）を実装する。

### 4. Claude Code への重要なルール
*   **ブラウザ側のコードで `fs` (ファイルシステム) モジュールを使用しないこと**。
*   **頻繁に検証せよ**: 各コンポーネントを有効にするたびに、画面が真っ白にならないことを確認すること。
*   **ペルソナを尊重せよ**: 陣内の対話は、日本語で鋭いものでなければならない。

---
**リポジトリパス**: `c:/Users/jonso/.gemini/books`
**開始地点**: `src/App.tsx`
